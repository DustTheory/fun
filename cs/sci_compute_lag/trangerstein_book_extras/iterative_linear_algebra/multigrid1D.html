<HTML>
  <HEAD>
    <meta charset="UTF-8">
    <TITLE> Multigrid in 1D </TITLE>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
    ></script>
  </HEAD>
  <BODY>
    <h2> Multigrid in 1D </h2>
    <script src=MGLevel1D.js></script>
    <script src=../plotting/XYGraphTool.js></script>
    <script type="text/javascript">
      var decay_number = 1.;
      var mu_in = 4;
      var mu = Number.POSITIVE_INFINITY;
      var EQUATION = { LAPLACE: 0, HEAT: 1 };
      var equation_name = [ "Laplace equation", "heat equation" ];
      var equation = EQUATION.LAPLACE;
      var DIFFUSION = { CONSTANT: 0, RANDOM: 1 };
      var diffusion_name = [ "constant diffusion", "random diffusion" ];
      var diffusion = DIFFUSION.CONSTANT;

      var step = -1;
      var log_error = new Array( );
      var smoother = SMOOTHER.GAUSS_SEIDEL;
      var restriction_prolongation =
        RESTRICTION_PROLONGATION.FINITE_ELEMENT;
//    var lambda_max = 0.;

      var finest_level = null;
      var solution = null;
      var true_solution = null;
      var true_increment = null;
      var rhs = null;
      var residual = null;
      var solution_increment = null;

      function arrayBounds( a , n ) {
        var alo = Number.MAX_VALUE;
        var ahi = -Number.MAX_VALUE;
        for ( var i = 1; i < n; i ++ ) {
          alo = Math.min( alo, a[ i ] );
          ahi = Math.max( ahi, a[ i ] );
        }
        return { 
          lo : alo,
          hi : ahi
        }
      }
      function plotOne( gt, data, nc ) {
        var dx = 1. / nc;
        gt.setBgColor( "white" );
        gt.newPage();
        gt.setFgColor( "black" );
        gt.drawAxes();
        gt.setFgColor( "blue" );
        gt.beginDrawing();
          if ( nc > 2 ) {
            gt.movePen( dx, data[ 1 ] );
            var x = dx + dx;
            for ( var i = 2; i < nc; i ++, x += dx ) {
              gt.drawLine( x, data[ i ] );
            }
          } else {
            gt.drawPlus( dx, data[ 1 ], dx * 0.125 );
          }
        gt.endDrawing();
      }
      function overplotTrueIncrement( gt ) {
        var dx = 1. / ncells;
        gt.setFgColor( "red" );
        gt.beginDrawing();
          gt.movePen( dx, true_increment[ 1 ] );
          var x = dx + dx;
          for ( var i = 2; i < ncells; i ++, x += dx ) {
            gt.drawLine( x, true_increment[ i ] );
          }
        gt.endDrawing();
      }
      function plotStuff( step ) {
//      document.getElementById("debug_textarea").value +=
//        "entering plotStuff\n";
        if ( step >= 0 ) {
          var rbounds = arrayBounds( finest_level.first_residual,
            finest_level.ilast );
          var rlo = rbounds.lo;
          var rhi = rbounds.hi;
          rbounds = arrayBounds( finest_level.residual1,
            finest_level.ilast );
          rlo = Math.min( rlo, rbounds.lo );
          rhi = Math.max( rhi, rbounds.hi );
          rbounds = arrayBounds( finest_level.Ax_b,
            finest_level.ilast );
          rlo = Math.min( rlo, rbounds.lo );
          rhi = Math.max( rhi, rbounds.hi );
          var ibounds = arrayBounds( true_increment,
            finest_level.ilast );
          var ilo = ibounds.lo;
          var ihi = ibounds.hi;
          ibounds = arrayBounds( finest_level.solution_increment0,
            finest_level.ilast );
          ilo = Math.min( ilo, ibounds.lo );
          ihi = Math.max( ihi, ibounds.hi );
          ibounds = arrayBounds( finest_level.solution_increment1,
            finest_level.ilast );
          ilo = Math.min( ilo, ibounds.lo );
          ihi = Math.max( ihi, ibounds.hi );
          ibounds = arrayBounds( finest_level.solution_increment,
            finest_level.ilast );
          ilo = Math.min( ilo, ibounds.lo );
          ihi = Math.max( ihi, ibounds.hi );
          if ( finest_level.coarser != null ) {
            var coarser_level = finest_level.coarser;
            rbounds = arrayBounds( coarser_level.first_residual,
              coarser_level.ilast );
            rlo = Math.min( rlo, rbounds.lo );
            rhi = Math.max( rhi, rbounds.hi );
            rbounds = arrayBounds( coarser_level.residual1,
              coarser_level.ilast );
            rlo = Math.min( rlo, rbounds.lo );
            rhi = Math.max( rhi, rbounds.hi );
            rbounds = arrayBounds( coarser_level.Ax_b,
              coarser_level.ilast );
            rlo = Math.min( rlo, rbounds.lo );
            rhi = Math.max( rhi, rbounds.hi );
            ibounds = arrayBounds( coarser_level.solution_increment0,
              coarser_level.ilast );
            ilo = Math.min( ilo, ibounds.lo );
            ihi = Math.max( ihi, ibounds.hi );
            ibounds = arrayBounds( coarser_level.solution_increment1,
              coarser_level.ilast );
            ilo = Math.min( ilo, ibounds.lo );
            ihi = Math.max( ihi, ibounds.hi );
            ibounds = arrayBounds( coarser_level.solution_increment,
              coarser_level.ilast );
            ilo = Math.min( ilo, ibounds.lo );
            ihi = Math.max( ihi, ibounds.hi );
            if ( coarser_level.coarser != null ) {
              var coarsest_level = coarser_level.coarser;
              rbounds = arrayBounds( coarsest_level.first_residual,
                coarsest_level.ilast );
              rlo = Math.min( rlo, rbounds.lo );
              rhi = Math.max( rhi, rbounds.hi );
              ibounds = arrayBounds( coarsest_level.solution_increment,
                coarsest_level.ilast );
              ilo = Math.min( ilo, ibounds.lo );
              ihi = Math.max( ihi, ibounds.hi );
            }
          }
//        document.getElementById("debug_textarea").value +=
//          "residual plot bounds = " + rlo + " to " + rhi + "\n";
//        document.getElementById("debug_textarea").value +=
//          "increment plot bounds = " + ilo + " to " + ihi + "\n";

          var gt_l0_residual0 = new XYGraphTool(
            document.getElementById("l0_residual0_canvas"),
            "residual0 vs x", "x", "residual0", 0., 1.,
            rlo, rhi );
          plotOne( gt_l0_residual0, finest_level.first_residual,
            finest_level.ncells );
          var gt_l0_increment0 = new XYGraphTool(
            document.getElementById("l0_increment0_canvas"),
            "increment0 vs x", "x", "increment0", 0., 1.,
            ilo, ihi );
          plotOne( gt_l0_increment0, finest_level.solution_increment0,
            finest_level.ncells );
          overplotTrueIncrement( gt_l0_increment0 );
          var gt_l0_residual1 = new XYGraphTool(
            document.getElementById("l0_residual1_canvas"),
            "residual1 vs x", "x", "residual1", 0., 1.,
            rlo, rhi );
          plotOne( gt_l0_residual1, finest_level.residual1 ,
            finest_level.ncells );
          if ( finest_level.coarser != null ) {
            var coarser_level = finest_level.coarser;
            var gt_l1_residual0 = new XYGraphTool(
              document.getElementById("l1_residual0_canvas"),
              "residual0 vs x", "x", "residual0", 0., 1.,
              rlo, rhi );
            plotOne( gt_l1_residual0, coarser_level.first_residual,
              coarser_level.ncells );
            var gt_l1_increment0 = new XYGraphTool(
              document.getElementById("l1_increment0_canvas"),
              "increment0 vs x", "x", "increment0", 0., 1.,
              ilo, ihi );
            plotOne( gt_l1_increment0, coarser_level.solution_increment0,
              coarser_level.ncells );
            var gt_l1_residual1 = new XYGraphTool(
              document.getElementById("l1_residual1_canvas"),
                "residual1 vs x", "x", "residual1", 0., 1.,
                rlo, rhi );
            plotOne( gt_l1_residual1, coarser_level.residual1 ,
              coarser_level.ncells );
            if ( coarser_level.coarser != null ) {
              var coarsest_level = coarser_level.coarser;
              var gt_l2_residual1 = new XYGraphTool(
                document.getElementById("l2_residual2_canvas"),
                  "residual vs x", "x", "residual", 0., 1.,
                  rlo, rhi );
              plotOne( gt_l2_residual1, coarsest_level.first_residual ,
                coarsest_level.ncells );
              var gt_l2_increment1 = new XYGraphTool(
                document.getElementById("l2_increment1_canvas"),
                "increment vs x", "x", "increment", 0., 1.,
                ilo, ihi );
              plotOne( gt_l2_increment1, coarsest_level.solution_increment,
                coarsest_level.ncells );
            }
            var gt_l1_increment2 = new XYGraphTool(
              document.getElementById("l1_increment2_canvas"),
              "increment2 vs x", "x", "increment2", 0., 1.,
              ilo, ihi );
            plotOne( gt_l1_increment2, coarser_level.solution_increment1,
              coarser_level.ncells );
            var gt_l1_residual3 = new XYGraphTool(
              document.getElementById("l1_residual3_canvas"),
                "residual2 vs x", "x", "residual2", 0., 1.,
                rlo, rhi );
            plotOne( gt_l1_residual3, coarser_level.Ax_b ,
              coarser_level.ncells );
            var gt_l1_increment3 = new XYGraphTool(
              document.getElementById("l1_increment3_canvas"),
              "increment3 vs x", "x", "increment3", 0., 1.,
              ilo, ihi );
            plotOne( gt_l1_increment3, coarser_level.solution_increment,
              coarser_level.ncells );
          }
          var gt_l0_increment2 = new XYGraphTool(
            document.getElementById("l0_increment2_canvas"),
            "increment2 vs x", "x", "increment2", 0., 1.,
            ilo, ihi );
          plotOne( gt_l0_increment2, finest_level.solution_increment1,
            finest_level.ncells );
          overplotTrueIncrement( gt_l0_increment2 );
          var gt_l0_residual3 = new XYGraphTool(
            document.getElementById("l0_residual3_canvas"),
            "residual3 vs x", "x", "residual3", 0., 1.,
            rlo, rhi );
          plotOne( gt_l0_residual3, finest_level.Ax_b ,
            finest_level.ncells );
          var gt_l0_increment3 = new XYGraphTool(
            document.getElementById("l0_increment3_canvas"),
            "increment3 vs x", "x", "increment3", 0., 1.,
            ilo, ihi );
          plotOne( gt_l0_increment3, finest_level.solution_increment,
            finest_level.ncells );
          overplotTrueIncrement( gt_l0_increment3 );
        }
        var gt_solution = new XYGraphTool(
          document.getElementById("l0_solution_canvas"),
          "solution vs x", "x", "solution", 0., 1., 0., 1. );
        gt_solution.setBgColor( "white" );
        gt_solution.newPage();
        gt_solution.setFgColor( "black" );
        gt_solution.drawAxes();
        gt_solution.setFgColor( "blue" );
        var dx = 1. / ncells;
        gt_solution.beginDrawing();
          gt_solution.movePen( 0., 1. );
          var x = dx;
          for ( var i = 1; i < ncells; i ++, x += dx ) {
            gt_solution.drawLine( x, solution[ i ] );
          }
          gt_solution.drawLine( 1., 0. );
        gt_solution.endDrawing();
        gt_solution.setFgColor( "red" );
        gt_solution.beginDrawing();
          gt_solution.movePen( 0., 1. );
          gt_solution.drawLine( 1., 0. );
        gt_solution.endDrawing();

//      document.getElementById("debug_textarea").value +=
//        "leaving plotStuff\n";
      }
      function takeStep( ) {
//      document.getElementById("debug_textarea").value +=
//        "entering takeStep\n";
        finest_level.multigridStep( residual, solution_increment );
        step ++;
        for ( var i = 1; i <= ncells - 1; i ++ ) {
          solution[ i ] -= solution_increment[ i ];
        }
        plotStuff( step );

        true_increment[ 0 ] = 0.;
        true_increment[ ncells ] = 0.;
        for ( var i = 1; i <= ncells - 1; i ++ ) {
          true_increment[ i ] = solution[ i ] - true_solution[ i ];
        }
        finest_level.computeResidual( solution, rhs, residual );
//      A-norm of true_increment
        var dot = 0.;
        for ( var i = 1; i <= ncells - 1; i ++ ) {
          dot += residual[ i ] * true_increment[ i ];
        }
        dot = Math.sqrt( dot );
        log_error.push( Math.log( dot ) / Math.log( 10. ) );
//      document.getElementById("debug_textarea").value +=
//        "A-norm of true_increment = " + dot + "\n";
        var err_min = Number.MAX_VALUE;
        var err_max = -Number.MAX_VALUE;
        for ( var i = 0; i < log_error.length; i ++ ) {
          err_min = Math.min( err_min, log_error[ i ] );
          err_max = Math.max( err_max, log_error[ i ] );
        }
        var gt_error = new XYGraphTool(
          document.getElementById("debug_canvas"),
          "A-norm of solution error vs iteration",
          "iteration", "log_10(error)",
          0, log_error.length - 1, err_min, err_max );
        gt_error.setBgColor( "white" );
        gt_error.newPage();
        gt_error.setFgColor( "black" );
        gt_error.drawAxes();
        gt_error.setFgColor( "blue" );
        gt_error.beginDrawing();
          gt_error.movePen( 0, log_error[ 0 ] );
          for ( var i = 1; i < log_error.length; i ++ ) {
            gt_error.drawLine( i, log_error[ i ] );
          }
        gt_error.endDrawing();
//      document.getElementById("debug_textarea").value +=
//        "leaving takeStep\n";
      }
      function onStart( ) {
//      document.getElementById("debug_textarea").value +=
//        "entering onStart\n";
        ncells = Math.max( 8,
          Math.floor( document.getElementsByName('ncells_text')[0].value ) );
        var smoother_iterations = Math.max( 1, Math.floor(
          document.getElementsByName('smoother_iterations_text')[0].value ) );
        var decay_number = Math.max( 0.,
          document.getElementsByName('decay_number_text')[0].value );
        var mu = Math.max( 0.,
          document.getElementsByName('mu_text')[0].value );
        var equation = EQUATION.LAPLACE;
        var equation_radio_buttons =
          document.getElementsByName("equation_radiobox");
        for ( var i = 0; i < equation_radio_buttons.length; i ++ ) {
          if ( equation_radio_buttons[ i ].checked ) {
            equation = Number( equation_radio_buttons[ i ].value );
            break;
          }
        }
        var diffusion = DIFFUSION.CONSTANT;
        var diffusion_radio_buttons =
          document.getElementsByName("diffusion_radiobox");
        for ( var i = 0; i < diffusion_radio_buttons.length; i ++ ) {
          if ( diffusion_radio_buttons[ i ].checked ) {
            diffusion = Number( diffusion_radio_buttons[ i ].value );
            break;
          }
        }
        var smoother_radio_buttons =
          document.getElementsByName("smoother_radiobox");
        for ( var i = 0; i < smoother_radio_buttons.length; i ++ ) {
          if ( smoother_radio_buttons[ i ].checked ) {
            smoother = Number( smoother_radio_buttons[ i ].value );
            break;
          }
        }
        var prolongation_radio_buttons =
          document.getElementsByName("prolongation_radiobox");
        for ( var i = 0; i < prolongation_radio_buttons.length; i ++ ) {
          if ( prolongation_radio_buttons[ i ].checked ) {
            restriction_prolongation =
              Number( prolongation_radio_buttons[ i ].value );
            break;
          }
        }

        var dx = 1. / ncells;
        var dt = decay_number * dx * dx;
        var n = ncells + 1;
        var n2 = n * 2;

        var matrix = new Array( n * 3 );
        rhs = new Array( n );
        solution = new Array( n );
        true_solution = new Array( n );
        true_increment = new Array( n );
        residual = new Array( n );
        solution_increment = new Array( n );

        for ( var i = 0; i < n * 3; i ++ ) {
          matrix[ i ] = Number.POSITIVE_INFINITY;
        }
        var diffusion_coef = new Array( ncells );
        var c = 1. / dx;
        switch ( diffusion ) {
          case DIFFUSION.CONSTANT : {
            for ( var i = 0; i < ncells; i ++ ) diffusion_coef[ i ] = c;
            break;
          }
          case DIFFUSION.RANDOM : {
            for ( var i = 0; i < ncells; i ++ ) {
              diffusion_coef[ i ] = c * Math.random();
            }
            break;
          }
        }
        switch ( equation ) {
          case EQUATION.LAPLACE : {
            for ( var i = 1; i <= ncells - 1; i ++ ) {
              matrix[ i ] = - diffusion_coef[ i - 1 ];
              matrix[ i + n ] = diffusion_coef[ i - 1 ] + diffusion_coef[i];
              matrix[ i + n2 ] = - diffusion_coef[ i ];
            }
            break;
          }
          case EQUATION.HEAT : {
            for ( var i = 0; i < ncells; i ++ ) diffusion_coef[ i ] *= dt;
            for ( var i = 1; i <= ncells - 1; i ++ ) {
              matrix[ i ] = - diffusion_coef[ i - 1 ];
              matrix[ i + n ] =
                dx + diffusion_coef[ i - 1 ] + diffusion_coef[i];
              matrix[ i + n2 ] = - diffusion_coef[ i ];
            }
            break;
          }
        }
/*
//      estimate largest eigenvalue
        lambda_max = Math.max( matrix[ 1 + n ] - matrix[ 1 + n2 ] );
        for ( var i = 2; i < ncells - 1; i ++ ) {
          lambda_max = Math.max( lambda_max, 
            matrix[ i + n ] - matrix[ i ] - matrix[ i + n2 ] );
        }
        var i = ncells - 1;
        lambda_max = Math.max( lambda_max,
          matrix[ i + n ] - matrix[ i + n2 ] );
//      document.getElementById("debug_textarea").value =
//        "largest eigenvalue >= " + lambda_max + "\n";
*/
//      Dirichlet boundary conditions at left and right
        for ( var i = 0; i <= ncells; i ++ ) {
          true_solution[ i ] = 1. - i * dx ;
        }
//      rhs = matrix * true_solution
        var i = 1;
        rhs[ i ] = matrix[ i + n ] * true_solution[ i ]
                 + matrix[ i + n2 ] * true_solution[ i + 1 ];
        for ( var i = 2; i <= ncells - 1; i ++ ) {
          rhs[ i ] = matrix[ i ] * true_solution[ i - 1 ]
                   + matrix[ i + n ] * true_solution[ i ]
                   + matrix[ i + n2 ] * true_solution[ i + 1 ];
        }
        i = ncells - 1;
        rhs[ i ] = matrix[ i ] * true_solution[ i - 1 ]
                 + matrix[ i + n ] * true_solution[ i ];
//      random initial guess
        for ( var i = 1; i <= ncells - 1; i ++ ) {
          solution[ i ] = Math.random();
          true_increment[ i ] = solution[ i ] - true_solution[ i ];
        }
        finest_level = new Level( ncells, smoother_iterations,
          smoother, restriction_prolongation );
        finest_level.setup( matrix );
        finest_level.computeResidual( solution, rhs, residual );
//      A-norm of true_increment
        var dot = 0.;
        for ( var i = 1; i <= ncells - 1; i ++ ) {
          dot += residual[ i ] * true_increment[ i ];
        }
        dot = Math.sqrt( dot );
        log_error = new Array();
        log_error.push( Math.log( dot ) / Math.log( 10. ) );
//      document.getElementById("debug_textarea").value +=
//        "A-norm of true_increment = " + dot + "\n";
        plotStuff( -1 );
        step = 0;
//      document.getElementById("debug_textarea").value +=
//        "leaving onStart\n";
      }

      function scientificFormat( n ) {
        var an = Math.abs(n);
        if ( an>=0.01 && an<=100. ) return n.toString();
        else return n.toExponential();
      }
    </script>
    ncells:
    <input
      type="text"
      name="ncells_text"
      value="8"
      size="3"
    >
    <br>
    smoother iterations:
    <input
      type="text"
      name="smoother_iterations_text"
      value="1"
      size="2"
    >
    <br>
    decay number:
    <input
      type="text"
      name="decay_number_text"
      value="1."
      size="10"
    >
    <br>
    Richardson mu:
    <input
      type="text"
      name="mu_text"
      value="4."
      size="10"
    >
    <br>
    <fieldset>
      <legend> equation </legend>
      <label for="laplace_equation_option">
        <input
          type="radio"
          checked value="0"
          id="equation_option_checkbox"
          name="equation_radiobox"
        />
        Laplace equation
        \( - D_{i+1/2} \frac{ u_{i+1} - u_i }{ {\scriptstyle \triangle} x }
           + D_{i-1/2} \frac{ u_i - u_{i-1} }{ {\scriptstyle \triangle} x }
           = 0 \;,\; u_0 = 1, u_N = 0 \)
      </label>
      <br>
      <label for="heat_equation_option">
        <input
          type="radio"
          value="1"
          id="equation_option_checkbox"
          name="equation_radiobox"
        />
        Heat equation
        \( ( u_i^{n+1} - u_i^n ) {\scriptstyle \triangle} x
       - \left[ D_{i+1/2} \frac{ u_{i+1}^{n+1} - u_i^{n+1} }
                               { {\scriptstyle \triangle} x }
              - D_{i-1/2} \frac{ u_i^{n+1} - u_{i-1}^{n+1} }
                               { {\scriptstyle \triangle} x }
         \right] {\scriptstyle \triangle} t = 0 \;,\;
         u_0^{n+1} = 1, u_N^{n+1} = 0 \;,\;
         u_j^n = 1 - j {\scriptstyle \triangle} x \)
      </label>
    </fieldset>
    <br>
    <fieldset>
      <legend> diffusion </legend>
      <label for="constant_diffusion_option">
        <input
          type="radio"
          checked value="0"
          id="diffusion_option_checkbox"
          name="diffusion_radiobox"
        />
        constant diffusion
      </label>
      <label for="heat_equation_option">
        <input
          type="radio"
          value="1"
          id="diffusion_option_checkbox"
          name="diffusion_radiobox"
        />
        random diffusion
      </label>
    </fieldset>
    <br>
    <fieldset>
      <legend> smoother </legend>
      <label for="gauss_seidel_smoother_option">
        <input
          type="radio"
          checked value="0"
          id="smoother_option_checkbox"
          name="smoother_radiobox"
        />
        Gauss-Seidel smoother
      </label>
      <label for="gauss_seidel_red_black_smoother_option">
        <input
          type="radio"
          value="1"
          id="smoother_option_checkbox"
          name="smoother_radiobox"
        />
        Gauss-Seidel Red-Black
      </label>
      <label for="richardson_smoother_option">
        <input
          type="radio"
          value="2"
          id="smoother_option_checkbox"
          name="smoother_radiobox"
        />
        Richardson
      </label>
    </fieldset>
    <br>
    <fieldset>
      <legend> prolongation </legend>
      <label for="algebraic_multigrid_prolongation_option">
        <input
          type="radio"
          checked value="0"
          id="prolongation_option_checkbox"
          name="prolongation_radiobox"
        />
        algebraic multigrid
      </label>
      <label for="finite_element_prolongation_option">
        <input
          type="radio"
          value="1"
          id="prolongation_option_checkbox"
          name="prolongation_radiobox"
        />
        finite element
      </label>
    </fieldset>
    <br>
    <input
      type="button"
      value="Take multigrid step"
      onclick="takeStep();"
    >
    <br>
    <input
      type="button"
      value="Start Over"
      onclick="onStart();"
    >
    <br>
    <table border cellspacing=0 cellpadding=5>
      <caption align=top>
        Multigrid Arrays
      </caption>
      <tr align=center>
        <th>action</th>
        <th>Level 0</th>
        <th>Level 1</th>
        <th>Level 2</th>
      </tr>
      <tr align=center>
        <th>first residual</th>
        <td>
          <canvas id="l0_residual0_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l1_residual0_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l2_residual0_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
      </tr>
      <tr align=center>
        <th>pre smooth ==> first increment</th>
        <td>
          <canvas id="l0_increment0_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l1_increment0_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l2_increment0_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
      </tr>
      <tr align=center>
        <th>update ==> second residual</th>
        <td>
          <canvas id="l0_residual1_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l1_residual1_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l2_residual1_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
      </tr>
      <tr align=center>
        <th>restrict ==> coarser first residual</th>
        <td>
          <canvas id="l0_residual2_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l1_residual2_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l2_residual2_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
      </tr>
      <tr align=center>
        <th>recurse or solve</th>
        <td>
          <canvas id="l0_increment1_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l1_increment1_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l2_increment1_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
      </tr>
      <tr align=center>
        <th>prolong ==> finer increment</th>
        <td>
          <canvas id="l0_increment2_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l1_increment2_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l2_increment2_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
      </tr>
      <tr align=center>
        <th>update ==> third  residual</th>
        <td>
          <canvas id="l0_residual3_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l1_residual3_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l2_residual3_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
      </tr>
      <tr align=center>
        <th>post smooth ==> final increment</th>
        <td>
          <canvas id="l0_increment3_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l1_increment3_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l2_increment3_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
      </tr>
      <tr align=center>
        <th>add increment ==> finest solution</th>
        <td>
          <canvas id="l0_solution_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l1_solution_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
        <td>
          <canvas id="l2_solution_canvas" width="200" height="100">
            Apparently, your browser does not support the HTML5
            <code>&lt;canvas&gt;</code> element
          </canvas>
        </td>
      </tr>
    </table>
    <br>
    The work proceeds as follows: <br>
    <ul>
      <li> compute residual on finest level (first plot in Level 0 column)
      <li> on Level 0, smooth and update the residual (second and third
        plots in Level 0 column)
      <li> restrict Level 0 residual (first plot in Level 1 column)
      <li> on Level 1, smooth and update the residual (second and third
        plots in Level 1 column)
      <li> restrict Level 1 residual (first plot in Level 2 column)
      <li> solve or recurse to get solution increment
        (second plot in Level 2 column)
      <li> prolong Level2 increment (fourth plot in Level 1 column)
      <li> update residual and smooth
         (fifth and sixth plots in Level 1 columns)
      <li> prolong Level1 increment (fourth plot in Level 0 column)
      <li> update residual and smooth
         (fifth and sixth plots in Level 0 columns)
      <li> update solution (last plot in Level 0 column)
    </ul>
    On the finest level (Level 0), the multigrid increments are plotting in
    blue, while the true increment is plotted in red.
    <br>
    <canvas id="debug_canvas" width="500" height="300">
      Apparently, your browser does not support the HTML5
      <code>&lt;canvas&gt;</code> element
    </canvas>
    <br>
<!--
-->
<!--
    <textarea
      id="debug_textarea"
      cols=100
      rows=50
    >
    </textarea>
-->
    <script language="javascript"> onStart(); </script>
  </BODY>
</HTML>
