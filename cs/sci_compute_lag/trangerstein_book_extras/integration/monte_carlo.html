<HTML>
  <HEAD>
    <meta charset="UTF-8">
    <TITLE> Monte Carlo Method </TITLE>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
    ></script>
    <script src=../plotting/XYGraphTool.js></script>
    <script language="javascript"> 
      function f(x) { return x*x; }
      var a = 0;
      var b = 1;
      var f_expected = 1/3; // E(f) = int_a^b f(x) dx / (b-a)
      var f_variance = 4/45; // int_a^b [ f(x) - E(f) ]^2 dx / ( b- a )
      var len = b - a;

      var n = undefined;
      var k = undefined;
      var xarray = undefined;
      var yarray = undefined;
      var zarray = undefined;
      var ymin = undefined;
      var ymax = undefined;
      function onStart() {
        n = 2;
        k = 0;
        xarray = new Array(1);
        yarray = new Array(1);
        zarray = new Array(1);
        ymin = Number.MAX_VALUE;
        ymax = -Number.MAX_VALUE;
        plotError();
      }
      function plotError() {
//      document.getElementById("debug_textarea").value +=
//        "in plotError\n";
        document.getElementById("debug_textarea").value =
          "sample size = " + n + "\n";
        var sum = 0;
        for ( var i = 0; i < n; i ++ ) {
          sum += f( a + len * Math.random() );
        }
//      note that the computed integral is (len * sum / n), not (sum / n)
        yarray[ k ] =
          Math.LOG10E* Math.log( Math.abs( sum / n - f_expected ) );
        ymax = Math.max( ymax, yarray[ k ] );
        ymin = Math.min( ymin, yarray[ k ] );
        xarray[ k ] = Math.LOG10E * Math.log( n ); 
        zarray[ k ] = Math.LOG10E
          * Math.log( f_variance / Math.sqrt( n ) );

        if ( k > 0 ) {
          var cnvs = document.getElementById("monte_carlo_canvas");
          var gt = new XYGraphTool( cnvs, "error in monte carlo",
            "log_10(n)","log_10(error)",
            xarray[ 0 ], xarray[ k ], ymin, ymax );
          gt.setBgColor( "white" );
          gt.newPage();
          gt.setFgColor( "black" );
          gt.drawAxes();
          gt.setFgColor( "blue" );
          gt.beginDrawing();
            gt.movePen(xarray[0],yarray[0]);
            for (var i=1;i<=k;i++) {
              gt.drawLine(xarray[i],yarray[i]);
            }
          gt.endDrawing();
          gt.setFgColor( "red" );
          gt.beginDrawing();
            gt.movePen(xarray[0],zarray[0]);
            for (var i=1;i<=k;i++) {
              gt.drawLine(xarray[i],zarray[i]);
            }
          gt.endDrawing();
        }
        n *= 2;
        k ++;
      }
    </script>
  </HEAD>
  <BODY>
    <h2>
      Monte Carlo method to compute
      $$\int_0^1 x^2 \; d x$$
    </h2>
    <br>
      error in Monte Carlo method in blue, estimated error in red
    <br>
    <canvas
      id="monte_carlo_canvas"
      width="500"
      height="500"
    >
      Apparently, your browser does not support the HTML5
      <code>&lt;canvas&gt;</code> element
    </canvas>
    <br>
    <input
      type="button"
      value="Start Over"
      onclick="onStart();"
    >
    <br>
    <input
      type="button"
      value="double the sample size"
      onclick="plotError();"
    >
    <br>
    <textarea
      id="debug_textarea"
      cols=100
      rows=1
    >
    </textarea>
    <script language="javascript"> onStart(); </script>
  </BODY>
</HTML>
<html><head></head><body></body></html>
