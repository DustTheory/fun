<HTML>
  <HEAD>
    <meta charset="UTF-8">
    <TITLE> Error in Centered Differences </TITLE>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
    ></script>
    <script src=../plotting/XYGraphTool.js></script>
    <script language="javascript"> 
      function f(x) { return Math.sin(x); }
      function fprime(x) { return Math.cos(x); }
      var TICK_LENGTH=0.01;
      function plotError() {
//      document.getElementById("debug_textarea").value +=
//        "in plotError\n";
        var x=1;
        var h=1;
        var nlevels=64;
        var exact=fprime(x);
        var x_array=new Array(nlevels);
        var y_array=new Array(nlevels);
        var ymin,ymax;
        for (var i=0;i<nlevels;i++) {
          var diff=(f(x+h)-f(x-h))/(2*h);
          x_array[i]=-Math.LOG10E * Math.log(h);
          y_array[i]=Math.LOG10E * Math.log(Math.abs(diff-exact));
          if (i==0) {
            ymin=y_array[i];
            ymax=y_array[i];
          } else {
            ymin=Math.min(ymin,y_array[i]);
            ymax=Math.max(ymax,y_array[i]);
          }
//        document.getElementById("debug_textarea").value +=
//          "i,x_array,y_array = " + i + " " + x_array[i] + " "
//          + y_array[i] + "\n";
          h*=0.5;
        }
        ymax=Math.max(ymax,0);
        ymin=Math.min(ymin,0);
//      document.getElementById("debug_textarea").value +=
//        "ymax,ymin = " + ymax + " " + ymin + "\n";

        var cnvs = document.getElementById("finite_difference_canvas");
        gt = new XYGraphTool( cnvs, "error in centered differences",
          "h","error", 0, 16, -16, 0 );
        gt.setBgColor( "white" );
        gt.newPage();
        gt.setFgColor( "black" );
        gt.drawAxes();
        gt.setFgColor( "blue" );
        gt.beginDrawing();
          gt.movePen(x_array[0],y_array[0]);
          for (var i=1;i<nlevels;i++) {
            gt.drawLine(x_array[i],y_array[i]);
          }
        gt.endDrawing();
      }
    </script>
  </HEAD>
  <BODY>
    <h2>
      Centered differences to compute
      $$\sin^\prime(x) \approx \frac{ \sin(x+h) - \sin(x-h) }{ 2 h }$$
    </h2>

    <canvas
      id="finite_difference_canvas"
      width="500"
      height="500"
    >
      Apparently, your browser does not support the HTML5
      <code>&lt;canvas&gt;</code> element
    </canvas>
<!--
    <br>
    <textarea
      id="debug_textarea"
      cols=100
      rows=50
    >
    </textarea>
-->
    <script language="javascript"> plotError(); </script>
  </BODY>
</HTML>
<html><head></head><body></body></html>
