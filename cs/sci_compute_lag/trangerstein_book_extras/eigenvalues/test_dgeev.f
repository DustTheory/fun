      program main
      integer i,info,n
      double precision a(4,4),wr(4),wi(4),vl(4,4),vr(4,4),work(16)

      n=4
c     [ 1  1  1  1 ] [ 3 -2  0 0 ] [ 1  1  1  1 ] = [ 14  2 -2  6 ]
c     [ 1 -1  1 -1 ] [ 2  3  0 0 ] [ 1 -1  1 -1 ] = [ -2 14 -6 -2 ]
c     [ 1  1 -1 -1 ] [ 0  0  4 1 ] [ 1  1 -1 -1 ] = [ -2  6 14  2 ]
c     [ 1 -1 -1  1 ] [ 0  0 -1 4 ] [ 1 -1 -1  1 ] = [ -6 -2 -2 14 ]
c     a(1,1)=14.d0
c     a(1,2)= 2.d0
c     a(1,3)=-2.d0
c     a(1,4)= 6.d0
c     a(2,1)=-2.d0
c     a(2,2)=14.d0
c     a(2,3)=-6.d0
c     a(2,4)=-2.d0
c     a(3,1)=-2.d0
c     a(3,2)= 6.d0
c     a(3,3)=14.d0
c     a(3,4)= 2.d0
c     a(4,1)=-6.d0
c     a(4,2)=-2.d0
c     a(4,3)=-2.d0
c     a(4,4)=14.d0

c     [ 1  1  1  1 ] [ 4  0  0 0 ] [ 1  1  1  1 ] = [ 11 -1  7 -1 ]
c     [ 1 -1  1 -1 ] [ 0  3 -2 0 ] [ 1 -1  1 -1 ] = [  7 11 -1 -1 ]
c     [ 1  1 -1 -1 ] [ 0  2  2 0 ] [ 1  1 -1 -1 ] = [ -1 -1 11  7 ]
c     [ 1 -1 -1  1 ] [ 0  0  0 1 ] [ 1 -1 -1  1 ] = [ -1  7 -1 11 ]
c     a(1,1)=11.d0
c     a(1,2)=-1.d0
c     a(1,3)= 7.d0
c     a(1,4)=-1.d0
c     a(2,1)= 7.d0
c     a(2,2)=11.d0
c     a(2,3)=-1.d0
c     a(2,4)=-1.d0
c     a(3,1)=-1.d0
c     a(3,2)=-1.d0
c     a(3,3)=11.d0
c     a(3,4)= 7.d0
c     a(4,1)=-1.d0
c     a(4,2)= 7.d0
c     a(4,3)=-1.d0
c     a(4,4)=11.d0

c     [ 1 0 0 0 ] [ 2 1 0 0 ] [ 1 0 0 0 ]^{-1} = [  0 1  0 0 ]
c     [ 2 1 0 0 ] [ 0 2 0 0 ] [ 2 1 0 0 ]      = [ -4 4  0 0 ]
c     [ 3 2 1 0 ] [ 0 2 3 1 ] [ 3 2 1 0 ]      = [ -5 2  1 1 ]
c     [ 4 3 2 1 ] [ 0 0 0 3 ] [ 4 3 2 1 ]      = [ -6 3 -4 5 ]
      a(1,1)= 0.d0
      a(1,2)= 1.d0
      a(1,3)= 0.d0
      a(1,4)= 0.d0
      a(2,1)=-4.d0
      a(2,2)= 4.d0
      a(2,3)= 0.d0
      a(2,4)= 0.d0
      a(3,1)=-5.d0
      a(3,2)= 2.d0
      a(3,3)= 1.d0
      a(3,4)= 1.d0
      a(4,1)=-6.d0
      a(4,2)= 3.d0
      a(4,3)=-4.d0
      a(4,4)= 5.d0
      print *, "a = ",((a(i,j),j=1,n),i=1,n)
      call dgeev('V','V',n,a,n,wr,wi,vl,n,vr,n,work,4*n,info)
      print *, "a = ",((a(i,j),j=1,n),i=1,n)
      print *, "wr = ",(wr(i),i=1,n)
      print *, "wi = ",(wi(i),i=1,n)
      print *, "vl = "
      do i=1,n
        print *, (vl(i,j),j=1,n)
      enddo
      print *, "vr = "
      do i=1,n
        print *, (vr(i,j),j=1,n)
      enddo
      stop
      end
