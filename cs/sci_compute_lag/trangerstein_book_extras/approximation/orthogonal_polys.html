<HTML>
  <HEAD>
    <meta charset="UTF-8">
    <TITLE>orthogonal polynomials</TITLE>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
    ></script>
  </HEAD>
  <BODY>
    <h2>
    orthogonal polynomials
    </h2>
    <br>
    <script src=../plotting/XYGraphTool.js></script>
    <script language="javascript">
      var parray = new Array();
      var colors = [ "red", "green", "blue", "yellow", "cyan", "magenta" ];
      var n = 1;
      var w = 1;
      var a = -1;
      var b = 1;
      var type = 0; // legendre:0, laguerre:1, chebyshev:2, hermite:3

      function legendre( x ) {
        parray = new Array( n + 1 );
        var pm2 = 0;
        var pm1 = 1;
        parray[ 0 ] = pm1;
        for ( var k = 1; k <= n; k ++ ) {
          var p = ( ( 2 * k - 1 ) * x * pm1 - ( k - 1 ) * pm2 ) / k;
          parray[ k ] = p;
          pm2 = pm1;
          pm1 = p;
        }
      }
      function laguerre( x ) {
        parray = new Array( n + 1 );
        var pm2 = 0;
        var pm1 = 1;
        parray[ 0 ] = pm1;
        for ( var k = 1; k <= n; k ++ ) {
          var p = ( ( 2 * k - 1 - x ) * pm1 - ( k - 1 ) * pm2 ) / k;
          parray[ k ] = p;
          pm2 = pm1;
          pm1 = p;
        }
      }
      function chebyshev( x ) {
        parray = new Array( n + 1 );
        var pm2 = 0;
        var pm1 = 1;
        parray[ 0 ] = pm1;
        for ( var k = 1; k <= n; k ++ ) {
          var p = 2 * x * pm1 - pm2;
          parray[ k ] = p;
          pm2 = pm1;
          pm1 = p;
        }
      }
      function hermite( x ) {
        parray = new Array( n + 1 );
        var pm2 = 0;
        var pm1 = 1;
        parray[ 0 ] = pm1;
        for ( var k = 1; k <= n; k ++ ) {
          var p = 2 * x * pm1 - 2 * ( k - 1 ) * pm2;
          parray[ k ] = p;
          pm2 = pm1;
          pm1 = p;
        }
      }
      function onStart() {
//      document.getElementById("debug_textarea").value +=
//        "entering onStart\n";
        var plot_canvas = document.getElementById("plot_canvas");
        w = plot_canvas.width;
        var radio_buttons =
          document.getElementsByName("polynomial_radiobox");
        for ( var i = 0; i < radio_buttons.length; i ++ ) {
          if ( radio_buttons[ i ].checked ) {
            type = Number( radio_buttons[ i ].value );
            break;
          }
        }
        n = Number( document.getElementById('n_textarea').value );
        n = Math.max( 1, Math.min( n, colors.length - 1 ) );
        var pmin = Number.MAX_VALUE;
        var pmax = -Number.MAX_VALUE;
        switch ( type ) {
          case 0: // legendre
            a = -1;
            b = 1;
            var dw = ( b - a ) / w;
            for ( var i = 0; i <= w; i ++ ) {
              var x = a + i * dw;
              legendre( x );
              for ( var j = 0; j <= n; j ++ ) {
                pmin = Math.min( pmin, parray[ j ] );
                pmax = Math.max( pmax, parray[ j ] );
              }
            }
            break;
          case 1: // laguerre
            a = 0; 
            b = 10;
            var dw = ( b - a ) / w;
            for ( var i = 0; i <= w; i ++ ) {
              var x = a + i * dw;
              laguerre( x );
              for ( var j = 0; j <= n; j ++ ) {
                pmin = Math.min( pmin, parray[ j ] );
                pmax = Math.max( pmax, parray[ j ] );
              }
            }
            break;
          case 2: // chebyshev
            a = -1;
            b = 1;
            var dw = ( b - a ) / w;
            for ( var i = 0; i <= w; i ++ ) {
              var x = a + i * dw;
              chebyshev( x );
              for ( var j = 0; j <= n; j ++ ) {
                pmin = Math.min( pmin, parray[ j ] );
                pmax = Math.max( pmax, parray[ j ] );
              }
            }
            break;
          case 3: // hermite
            a = -2;
            b = 2;
            var dw = ( b - a ) / w;
            for ( var i = 0; i <= w; i ++ ) {
              var x = a + i * dw;
              hermite( x );
              for ( var j = 0; j <= n; j ++ ) {
                pmin = Math.min( pmin, parray[ j ] );
                pmax = Math.max( pmax, parray[ j ] );
              }
            }
            break;
        }
        gt = new XYGraphTool( plot_canvas, "polynomials",
          "x", "p", a, b, pmin, pmax );
        gt.setBgColor( "white" );
        gt.newPage();
        gt.setFgColor( "black" );
        gt.drawAxes();
        var dw = ( b - a ) / w;
        for ( var j = 0; j <= n; j ++ ) {
          gt.setFgColor( colors[ j ] );
          gt.beginDrawing();
            switch ( type ) {
              case 0: // legendre
                legendre( a );
                gt.movePen( a, parray[ j ] );
                for ( var i = 1; i <= w; i ++ ) {
                  var x = a + i * dw;
                  legendre( x );
                  gt.drawLine( x, parray[ j ] );
                }
                break;
              case 1: // laguerre
                laguerre( a );
                gt.movePen( a, parray[ j ] );
                for ( var i = 1; i <= w; i ++ ) {
                  var x = a + i * dw;
                  laguerre( x );
                  gt.drawLine( x, parray[ j ] );
                }
                break;
              case 2: // chebyshev
                chebyshev( a );
                gt.movePen( a, parray[ j ] );
                for ( var i = 1; i <= w; i ++ ) {
                  var x = a + i * dw;
                  chebyshev( x );
                  gt.drawLine( x, parray[ j ] );
                }
                break;
              case 3: // hermite
                hermite( a );
                gt.movePen( a, parray[ j ] );
                for ( var i = 1; i <= w; i ++ ) {
                  var x = a + i * dw;
                  hermite( x );
                  gt.drawLine( x, parray[ j ] );
                }
                break;
            }
          gt.endDrawing();
        }
//      document.getElementById("debug_textarea").value +=
//        "leaving onStart\n";
      }
    </script>
    <canvas id="plot_canvas" width="500" height="300">
      Apparently, your browser does not support the HTML5
      <code>&lt;canvas&gt;</code> element
    </canvas>
    <br>
    Enter number of polynomials:
    <input
      type="text"
      name="n"
      value="2"
      size="1"
      id="n_textarea" >
    <br>
    <fieldset>
      <legend> Type of polynomial: </legend>
      <label for="legendre_option">
        <input
          type="radio"
          checked value="0"
          id="legendre_option_checkbox"
          name="polynomial_radiobox"
        />
        Legendre
      </label>
      <label for="laguerre_option">
        <input
          type="radio"
          value="1"
          id="laguerre_option_checkbox"
          name="polynomial_radiobox"
        />
        Laguerre
      </label>
      <label for="chebyshev_option">
        <input
          type="radio"
          value="2"
          id="chebyshev_option_checkbox"
          name="polynomial_radiobox"
        />
        Chebyshev
      </label>
      <label for="hermite_option">
        <input
          type="radio"
          value="3"
          id="hermite_option_checkbox"
          name="polynomial_radiobox"
        />
        Hermite
      </label>
    </fieldset>
    <br>
    <input
      type="button"
      value="Plot polynomials"
      onclick="onStart();"
    >
<!--
    <br>
    <textarea
      id="debug_textarea"
      cols=100
      rows=50
    >
--->
    </textarea>
    <script language="javascript"> onStart(); </script>
  </BODY>
</HTML>
