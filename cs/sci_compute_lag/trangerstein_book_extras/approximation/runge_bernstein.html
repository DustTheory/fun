<HTML>
  <HEAD>
    <meta charset="UTF-8">
    <TITLE>interpolate runge function</TITLE>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
  </HEAD>
  <BODY>
    approximate Runge function 
    \(f(x) = \frac{1}{1 + 25 x^2}\)
    on (a,b) = (-1,1) by Bernstein polynomial
    $$b(x) = \sum_{k=0}^n f\left(a + [ b - a ] \frac{k}{n} \right)
    \binom{n}{k} \left( \frac{x-a}{b-a} \right)^k
    \left( \frac{b-x}{b-a} \right)^{n-k}$$
    <br>
    Runge's function in red, Bernstein polynomial in blue
<!--
-->
    <br>
    <script src=../plotting/XYGraphTool.js></script>
    <script language="javascript">
      var xarray = new Array();
      var farray = new Array();
      var parray = new Array();
      var barray = new Array();
      var xpts = new Array();
      var ypts = new Array();
      var difs = new Array();
      var ymax = 0;
      var ymin = 0;
      var n = 0;

      function f( x ) { return 1 / ( 1 + 25 * x * x ); }
      function binomialCoefficients( ) {
        barray[ n ] = 1;
        for ( var j = n - 1; j > 0; j -- ) barray[ j ] += barray[ j - 1 ];
      }
      function computePoints( w ) {
        xpts = new Array( n + 1 );
        ypts = new Array( n + 1 );
        difs = new Array( n + 1 );
        var dx = 2 / n;
        for ( var k = 0; k <= n; k ++ ) {
          var x = dx * k - 1;
          xpts[ k ] = x;
          ypts[ k ] = f( x ) * barray[ k ];
        }

        xarray = new Array( w + 1 );
        var earray = new Array( w + 1 );
        farray = new Array( w + 1 );
        ymax = 1;
        ymin = 0;
        var dx = 2 / w;
        for ( var i = 0; i < w; i ++ ) {
          var x = dx * i - 1;
          xarray[ i ] = x;
          farray[ i ] = f( x );
          var r = ( 1 + x ) / ( 1 - x );
          var rk = 1;
          var sum = 0;
          for ( var k = 0; k <= n; k ++ ) {
            sum += ypts[ k ] * rk; 
            rk *= r;
          }
          parray[ i ] = sum * Math.pow( ( 1 - x ) * .5, n );
          ymax = Math.max( ymax, parray[ i ] );
          ymin = Math.min( ymin, parray[ i ] );
        }
        i = w;
        x = 1;
        xarray[ i ] = x;
        farray[ i ] = f( x );
        parray[ i ] = ypts[ n ];
        ymax = Math.max( ymax, parray[ i ] );
        ymin = Math.min( ymin, parray[ i ] );
      }
      function onStart() {
//      document.getElementById("debug_textarea").value +=
//        "entering onStart\n";
        n = 0;
        var interpolate_canvas =
          document.getElementById("interpolate_canvas");
        gt = new XYGraphTool( interpolate_canvas, "runge function",
          "x", "f", -1, 1, 0, 1 );
        binomialCoefficients();
        plotCase();
//      document.getElementById("debug_textarea").value +=
//        "leaving onStart\n";
      }
      function plotCase() {
        document.getElementById("debug_textarea").value =
          "n = " + n + "\n";
        n++;
        binomialCoefficients();
//      computePoints( 4 );
        computePoints( interpolate_canvas.width );
        gt.rescale( -1, 1, ymin, ymax );
        gt.setBgColor( "white" );
        gt.newPage();
        gt.setFgColor( "black" );
        gt.drawAxes();
        gt.setFgColor( "red" );
        gt.beginDrawing();
          gt.movePen( xarray[ 0 ], farray[ 0 ] );
          for ( var ii = 1; ii < xarray.length; ii ++ ) {
            gt.drawLine( xarray[ ii ], farray[ ii ] );
          }
        gt.endDrawing();
        gt.setFgColor( "blue" );
        gt.beginDrawing();
          gt.movePen( xarray[ 0 ], parray[ 0 ] );
          for ( ii = 1; ii < xarray.length; ii ++ ) {
            gt.drawLine( xarray[ ii ], parray[ ii ] );
          }
        gt.endDrawing();
      }
    </script>
    <canvas id="interpolate_canvas" width="500" height="300">
      Apparently, your browser does not support the HTML5
      <code>&lt;canvas&gt;</code> element
    </canvas>
    <br>
    <input
      type="button"
      value="Try higher-order polynomial"
      onclick="plotCase();"
    >
    <input
      type="button"
      value="Start over"
      onclick="onStart();"
    >
    <br>
    <textarea
      id="debug_textarea"
      cols=100
      rows=1
    >
    </textarea>
    <script language="javascript"> onStart(); </script>
  </BODY>
</HTML>
