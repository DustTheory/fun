<HTML>
  <HEAD>
    <meta charset="UTF-8">
    <TITLE>Daubechies D4 Scaling Function</TITLE>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
    ></script>
  </HEAD>
  <BODY>
    <h2>
    Daubechies D4 scaling function
    </h2>
    <br>
    <script src=../plotting/XYGraphTool.js></script>
    <script language="javascript">
      var m = 9;
      var twotom = Math.pow(2,m);
      var k = twotom;
      var n = 3 * k;
      var j = 0;
//    var colors = [ "magenta", "red", "orange", "yellow", "brown",
//      "green", "cyan", "blue", "black" ];
      var data = new Array( n );
      var gt = undefined;
      var lowpass = new Array( 4 );
      lowpass[ 0 ] = ( 1 + Math.sqrt( 3 ) ) * 0.125;
      lowpass[ 1 ] = ( 3 + Math.sqrt( 3 ) ) * 0.125;
      lowpass[ 2 ] = ( 3 - Math.sqrt( 3 ) ) * 0.125;
      lowpass[ 3 ] = ( 1 - Math.sqrt( 3 ) ) * 0.125;

      function onStart() {
//      document.getElementById("debug_textarea").value +=
//        "entering onStart\n";
        k = twotom;
        n = 3 * k;
        j = 0;
        var canvas = document.getElementById("scaling_fcn_canvas");
        gt = new XYGraphTool( canvas, "Daubechies D4 scaling function",
          "t", "phi", 0, 3, -2, 2 );
        gt.setBgColor( "white" );
        gt.newPage();
        gt.setFgColor( "black" );
        gt.setLineWidth( 1 );
        gt.drawAxes();

        data[ 0 ] = 0;
        data[ k ] = lowpass[ 0 ] * 4;
        data[ 2 * k ] = lowpass[ 3 ] * 4;
        gt.setFgColor( "blue" );
        gt.beginDrawing();
        var w = n / ( 3 * k );
          var t = 0;
          gt.movePen( t, data[ 0 ]);
          for ( var i = 1; i < n / k; i ++ ) {
            var t = i / w;
            gt.drawLine( t, data[ i * k ]);
          }
        gt.endDrawing();
//      document.getElementById("debug_textarea").value +=
//        "leaving onStart\n";
      }
      function refine() {
//      document.getElementById("debug_textarea").value +=
//        "entering refine\n";
        if ( j >= m ) return;
        j ++;
        k /= 2;
//      document.getElementById("debug_textarea").value =
//        "j = " + j + "\n";
        for ( var i = k; i < 3 * twotom; i += 2 * k ) {
          data[ i ] = 0;
//        refinement equation for scaling function:
          for ( var nn = 0; nn < 4; nn ++ ) {
            var ii = 2 * i - nn * twotom;
            if ( ii >= 0 && ii < 3 * twotom ) {
              data[ i ] += lowpass[ nn ] * data[ ii ];
            }
          }
          data[ i ] *= 2;
        }
        gt.newPage();
        gt.setBgColor( "white" );
        gt.newPage();
        gt.setFgColor( "black" );
        gt.setLineWidth( 1 );
        gt.drawAxes();

        gt.setFgColor( "blue" );
        gt.beginDrawing();
          var w = k / 512;
          gt.movePen( 0, data[ 0 ]);
          for ( var i = k; i < 3 * twotom; i += k ) {
            var t = i / 512;
            gt.drawLine( t, data[ i ]);
          }
        gt.endDrawing();
//      document.getElementById("debug_textarea").value +=
//        "leaving refine\n";
      }
    </script>
    <canvas id="scaling_fcn_canvas" width="512" height="512">
      Apparently, your browser does not support the HTML5
      <code>&lt;canvas&gt;</code> element
    </canvas>
    <br>
    <input
      type="button"
      value="refine"
      onclick="refine();"
    >
    <input
      type="button"
      value="Start Over"
      onclick="onStart();"
    >
<!--
    <br>
    <textarea
      id="debug_textarea"
      cols=100
      rows=1
    >
    </textarea>
-->
    <script language="javascript"> onStart(); </script>
  </BODY>
</HTML>
