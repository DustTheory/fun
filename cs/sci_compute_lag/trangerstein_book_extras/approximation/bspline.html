<HTML>
  <HEAD>
    <meta charset="UTF-8">
    <TITLE>cardinal B-spline</TITLE>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
    ></script>
  </HEAD>
  <BODY>
    <h2>
    cardinal B-spline
    </h2>
    <br>
    <script src=interpolate.js></script>
    <script src=../plotting/XYGraphTool.js></script>
    <script language="javascript">
      var bold = undefined;
      var bnew = undefined;
      var n = undefined;
      var order = undefined;
      var dx = undefined;

      function onStart() {
//      document.getElementById("debug_textarea").value +=
//        "entering onStart\n";
        n = 128;
        order = 1;
        bold = new Array(n+1);
        dx=1./n;
        for ( var i = 0; i < n; i++ ) bold[i]=1.;
        bold[n]=0.;
        interpolate_canvas = document.getElementById("interpolate_canvas");
        w = interpolate_canvas.width;
        gt = new XYGraphTool( interpolate_canvas, "cardinal B-spline",
          "x", "B_k", 0, 1, 0, 1 );
        gt.setBgColor( "white" );
        gt.newPage();
        gt.setFgColor( "black" );
        gt.drawAxes();
        gt.setFgColor( "blue" );
        gt.beginDrawing();
          gt.movePen( 0., bold[0] );
          for ( var i = 1; i <= n; i ++ ) {
            gt.drawLine( i*dx, bold[i] );
          }
        gt.endDrawing();
        document.getElementById("debug_textarea").value =
          "order = " + order + "\n";
//      document.getElementById("debug_textarea").value +=
//        "leaving onStart\n";
      }
      function plotCase() {
//      document.getElementById("debug_textarea").value +=
//        "entering plotCase\n";
        order ++;
        bnew = new Array( n + bold.length );
        for ( var i = 0; i < n; i++ ) {
          var t = i * dx;
          bnew[i] = bold[i] * t / ( order - 1 ); 
        }
        for ( var i = n; i < bold.length; i++ ) {
          var t = i * dx;
          bnew[i] = ( bold[i] * t + bold[i-n] * ( order - t ) )
                  / ( order - 1 )
        }
        for ( var i = bold.length; i < bnew.length; i++ ) {
          var t = i * dx;
          bnew[i] = bold[i-n] * ( order - t ) / ( order - 1 )
        }
        gt.rescale(0.,order,0.,1.);
        gt.setBgColor( "white" );
        gt.newPage();
        gt.setFgColor( "black" );
        gt.drawAxes();
        gt.setFgColor( "blue" );
        gt.beginDrawing();
          gt.movePen( 0., bnew[0] );
          for ( var i = 1; i < bnew.length; i ++ ) {
            gt.drawLine( i*dx, bnew[i] );
          }
        gt.endDrawing();
        bold = bnew;
        delete bnew;
        document.getElementById("debug_textarea").value =
          "order = " + order + "\n";
//      document.getElementById("debug_textarea").value +=
//        "leaving plotCase\n";
      }
    </script>
    <canvas id="interpolate_canvas" width="500" height="300">
      Apparently, your browser does not support the HTML5
      <code>&lt;canvas&gt;</code> element
    </canvas>
    <br>
    <input
      type="button"
      value="increase spline order"
      onclick="plotCase();"
    >
    <br>
    <textarea
      id="debug_textarea"
      cols=100
      rows=2
    >
    </textarea>
<!--
-->
    <script language="javascript"> onStart(); </script>
  </BODY>
</HTML>
