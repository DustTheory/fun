<HTML>
  <HEAD>
    <meta charset="UTF-8">
    <TITLE>interpolate runge function</TITLE>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
    ></script>
  </HEAD>
  <BODY>
    <h2>
    interpolate Runge's function at Chebyshev points
    </h2>
    <br>
    Runge's function in red, polynomial in blue
    <br>
    <script src=interpolate.js></script>
    <script src=../plotting/XYGraphTool.js></script>
    <script language="javascript">
      var xarray = new Array();
      var farray = new Array();
      var parray = new Array();
      var xpts = new Array();
      var ypts = new Array();
      var difs = new Array();
      var ymax = 0;
      var ymin = 0;
      var n = 0;

      function f( x ) { return 1 / ( 1 + 25 * x * x ); }
      function computePoints( n, w ) {
        xpts = new Array( n + 1 );
        ypts = new Array( n + 1 );
        difs = new Array( n + 1 );
        var dx = Math.PI / ( 2 * ( n + 1 ) );
        for ( var ii = 0; ii <= n; ii ++ ) {
          var x = Math.cos( ( 2 * ii + 1 ) * dx );
          xpts[ n - ii ] = x;
          ypts[ n - ii ] = f( x );
        }
        dividedDifference( n, xpts, ypts, difs );

        xarray = new Array( w + 1 );
        var earray = new Array( w + 1 );
        farray = new Array( w + 1 );
        ymax = 1;
        ymin = 0;
        var dx = 2 / w;
        for ( var ii = 0; ii <= w; ii ++ ) {
          var x = dx * ii - 1;
          xarray[ ii ] = x;
          farray[ ii ] = f( x );
          parray[ ii ] = newtonPolynomial( n, difs, xpts, x );
          ymax = Math.max( ymax, parray[ ii ] );
          ymin = Math.min( ymin, parray[ ii ] );
        }
      }
      function onStart() {
//      document.getElementById("debug_textarea").value +=
//        "entering onStart\n";
        n = 0;
        var interpolate_canvas =
          document.getElementById("interpolate_canvas");
        gt = new XYGraphTool( interpolate_canvas, "runge function",
          "x", "f", -1, 1, 0, 1 );
        plotCase();
//      document.getElementById("debug_textarea").value +=
//        "leaving onStart\n";
      }
      function plotCase() {
        n++;
        document.getElementById("debug_textarea").value =
          "n = " + n + "\n";
//      computePoints( n, 4 );
        computePoints( n, interpolate_canvas.width );
        gt.rescale( -1, 1, ymin, ymax );
        gt.setBgColor( "white" );
        gt.newPage();
        gt.setFgColor( "black" );
        gt.drawAxes();
        gt.setFgColor( "red" );
        gt.beginDrawing();
          gt.movePen( xarray[ 0 ], farray[ 0 ] );
          for ( var ii = 1; ii < xarray.length; ii ++ ) {
            gt.drawLine( xarray[ ii ], farray[ ii ] );
          }
        gt.endDrawing();
        gt.setFgColor( "blue" );
        gt.beginDrawing();
          gt.movePen( xarray[ 0 ], parray[ 0 ] );
          for ( var ii = 1; ii < xarray.length; ii ++ ) {
            gt.drawLine( xarray[ ii ], parray[ ii ] );
          }
        gt.endDrawing();
      }
    </script>
    <canvas id="interpolate_canvas" width="500" height="300">
      Apparently, your browser does not support the HTML5
      <code>&lt;canvas&gt;</code> element
    </canvas>
    <br>
    <input
      type="button"
      value="Try higher-order polynomial"
      onclick="plotCase();"
    >
    <input
      type="button"
      value="Start over"
      onclick="onStart();"
    >
    <br>
    <textarea
      id="debug_textarea"
      cols=100
      rows=1
    >
    </textarea>
    <script language="javascript"> onStart(); </script>
  </BODY>
</HTML>
